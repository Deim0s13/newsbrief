[
  {
    "title": "Re-enable security scanning and address vulnerabilities",
    "body": "## Description\n\nRe-enable Trivy security scanning in CI/CD pipeline and address any CRITICAL or HIGH vulnerabilities found.\n\n## Current State\n\nSecurity scanning is currently disabled with `continue-on-error: true` in `.github/workflows/ci-cd.yml` to prevent blocking deployments during v0.5.5 stabilization.\n\n```yaml\n- name: Run Trivy vulnerability scanner\n  uses: aquasecurity/trivy-action@master\n  continue-on-error: true  # Don't fail pipeline on security scan issues\n```\n\n## Acceptance Criteria\n\n- [ ] Review Trivy scan results manually\n- [ ] Fix any CRITICAL vulnerabilities found\n- [ ] Fix any HIGH vulnerabilities found\n- [ ] Remove `continue-on-error: true` from ci-cd.yml\n- [ ] Pipeline passes with security scan enabled\n- [ ] Consider adding security scan to PR checks\n- [ ] Document any accepted risks for LOW/MEDIUM findings\n\n## Technical Details\n\n**Files to Update**:\n- `.github/workflows/ci-cd.yml`\n- Document findings in `docs/security/SCAN_RESULTS.md` (create if needed)\n\n**Trivy Configuration**:\n```yaml\n- name: Run Trivy vulnerability scanner\n  uses: aquasecurity/trivy-action@master\n  with:\n    image-ref: 'ghcr.io/${{ github.repository }}:${{ github.sha }}'\n    format: 'sarif'\n    output: 'trivy-results.sarif'\n  # Remove continue-on-error once vulnerabilities are addressed\n```\n\n## Priority Justification\n\n**HIGH Priority** - Security vulnerabilities should be addressed before adding new features. This was temporarily disabled for v0.5.5 release but must be re-enabled for production readiness.\n\n## Estimated Effort\n\n2-3 hours:\n- 1h: Review scan results and research vulnerabilities\n- 1-2h: Fix vulnerabilities (dependency updates, config changes)\n- 30min: Test, document, and re-enable scanning\n\n## Related\n\n- Technical Debt: docs/development/TECHNICAL_DEBT_v0.6.0.md\n- CI/CD Workflow: .github/workflows/ci-cd.yml\n\n## Definition of Done\n\n- Security scan passes in CI/CD\n- No CRITICAL or HIGH vulnerabilities remain\n- `continue-on-error` flag removed\n- Findings documented",
    "labels": ["technical-debt", "security", "priority:P1", "epic:ops"],
    "milestone": "v0.6.0 - Intelligence & Polish"
  },
  {
    "title": "Fix remaining mypy type annotation warnings",
    "body": "## Description\n\nFix the remaining 30 mypy type annotation warnings to enable strict type checking without `continue-on-error`.\n\n## Current State\n\nMypy runs with `--no-strict-optional` and `continue-on-error: true` in CI/CD. All code is functionally correct, but type hints are incomplete.\n\n**Current CI/CD Configuration**:\n```yaml\n- name: Type checking\n  run: mypy app/ --ignore-missing-imports --no-strict-optional\n  continue-on-error: true  # Allow pipeline to continue with type warnings\n```\n\n**Remaining Warnings**: ~30 (see `docs/releases/v0.5.5/MYPY_STATUS_v0.5.5.md`)\n\n## Error Categories\n\n### 1. Optional Type Annotations (3 errors)\n- Missing Optional[] wrapper for nullable types\n- Example: `def foo(x: str)` should be `def foo(x: Optional[str])`\n\n### 2. SQL Result Type Hints (8 errors)\n- Missing explicit types for SQLAlchemy result rows\n- Example: `row = session.execute(...).first()` needs type annotation\n\n### 3. Missing Required Arguments (3 errors)\n- Function calls missing required parameters in type signature\n\n### 4. Type Incompatibilities (6 errors)\n- Argument types don't match function signatures\n- Return type mismatches\n\n### 5. Generator/Collection Types (10 errors)\n- Missing type annotations for generators, lists, dicts\n- Example: `def get_items() -> list` should be `def get_items() -> List[Item]`\n\n## Acceptance Criteria\n\n- [ ] All 30 mypy warnings resolved\n- [ ] Remove `--no-strict-optional` flag\n- [ ] Remove `continue-on-error: true` from CI/CD\n- [ ] Mypy passes with strict checking enabled\n- [ ] All tests still pass\n- [ ] No functional changes to code behavior\n\n## Implementation Strategy\n\n### Phase 1: Quick Fixes (1h)\n- Add missing Optional[] wrappers\n- Add missing function arguments\n- Fix obvious type mismatches\n\n### Phase 2: SQL Results (1h)\n- Add type annotations for database query results\n- Use Union types where needed for row tuples\n\n### Phase 3: Collections (30min-1h)\n- Add proper List[], Dict[], Generator[] types\n- Import from typing module\n\n## Files Likely Affected\n\n- `app/stories.py` - Story generation logic (SQL queries)\n- `app/feeds.py` - Feed management (SQL queries)\n- `app/main.py` - API endpoints (function signatures)\n- `app/db.py` - Database operations\n- `app/llm.py` - LLM interaction (optional types)\n\n## Priority Justification\n\n**MEDIUM Priority** - Improves code quality and maintainability. Not blocking features but important for long-term code health.\n\n## Estimated Effort\n\n2-3 hours:\n- 1h: Fix Optional and missing argument errors\n- 1h: Fix SQL result type hints\n- 30min-1h: Fix collection types and test\n\n## Related\n\n- Technical Debt: docs/development/TECHNICAL_DEBT_v0.6.0.md\n- Mypy Status: docs/releases/v0.5.5/MYPY_STATUS_v0.5.5.md\n- CI/CD Workflow: .github/workflows/ci-cd.yml\n\n## Testing\n\n```bash\n# Local testing\nmypy app/ --ignore-missing-imports --strict-optional\n\n# Verify no regressions\npytest\n```\n\n## Definition of Done\n\n- Mypy reports 0 errors with strict checking\n- CI/CD pipeline passes without continue-on-error\n- All tests pass\n- Code behavior unchanged",
    "labels": ["technical-debt", "code-quality", "priority:P2", "epic:ops"],
    "milestone": "v0.6.0 - Intelligence & Polish"
  },
  {
    "title": "Improve test coverage to 80%",
    "body": "## Description\n\nIncrease test coverage from current ~60% to target 80% by adding tests for critical paths and edge cases.\n\n## Current State\n\n**Estimated Coverage**: ~60% (no coverage tool currently configured)  \n**Test Framework**: pytest, pytest-asyncio  \n**Coverage Tool**: Not configured\n\n## Acceptance Criteria\n\n- [ ] Install and configure pytest-cov\n- [ ] Add coverage reporting to CI/CD pipeline\n- [ ] Achieve ≥80% overall code coverage\n- [ ] 100% coverage for critical paths:\n  - Story generation pipeline\n  - Story CRUD operations\n  - Feed processing and health scoring\n- [ ] Coverage report visible in CI/CD logs\n- [ ] Coverage badge added to README (optional)\n\n## Areas Needing Tests\n\n### Story Generation (High Priority)\n- [ ] Edge case: Single article (no clustering possible)\n- [ ] Edge case: All articles too dissimilar (no clusters formed)\n- [ ] Edge case: One mega-cluster (all articles similar)\n- [ ] Error handling: LLM unavailable during synthesis\n- [ ] Error handling: Invalid LLM response (malformed JSON)\n- [ ] Clustering algorithm with various similarity thresholds\n- [ ] Entity extraction edge cases\n\n### Scheduler (High Priority)\n- [ ] Scheduled story generation triggers correctly\n- [ ] Scheduled archiving works (7+ day old stories)\n- [ ] Scheduler status endpoint accuracy\n- [ ] Error handling during scheduled runs\n\n### Feed Health Scoring (Medium Priority)\n- [ ] Health score calculation with various success rates\n- [ ] Health score edge cases (100% failure, 100% success)\n- [ ] Response time impact on health scores\n- [ ] Health score updates over time\n\n### OPML Import/Export (Medium Priority)\n- [ ] Import with malformed XML\n- [ ] Import with missing required fields\n- [ ] Export with empty feed list\n- [ ] Export with special characters in feed names\n\n### API Endpoints (Medium Priority)\n- [ ] Error responses for invalid input\n- [ ] Pagination edge cases (empty results, single page)\n- [ ] Filtering edge cases (no matches, all matches)\n- [ ] Authentication edge cases (if auth is added)\n\n### Error Handling (Medium Priority)\n- [ ] Database connection failures\n- [ ] File system errors (OPML file not found)\n- [ ] Network errors during feed fetching\n- [ ] Invalid configuration values\n\n## Implementation Strategy\n\n### Phase 1: Setup (1h)\n```bash\n# Install coverage tool\npip install pytest-cov\n\n# Update requirements.txt\necho \"pytest-cov>=4.1.0\" >> requirements.txt\n\n# Generate initial coverage report\npytest --cov=app --cov-report=html --cov-report=term\n```\n\n### Phase 2: Critical Path Coverage (2-3h)\n- Focus on story generation pipeline\n- Add scheduler tests\n- Ensure CRUD operations are fully covered\n\n### Phase 3: Edge Cases & Error Handling (1-2h)\n- Add edge case tests\n- Test error handling paths\n- Verify exception handling\n\n### Phase 4: CI/CD Integration (30min)\n```yaml\n# Add to .github/workflows/ci-cd.yml\n- name: Run tests with coverage\n  run: |\n    pytest --cov=app --cov-report=term --cov-fail-under=80\n    \n- name: Upload coverage reports\n  uses: codecov/codecov-action@v3\n  if: always()\n```\n\n## Files to Update\n\n**New Test Files**:\n- `tests/test_story_generation_edge_cases.py`\n- `tests/test_scheduler.py`\n- `tests/test_feed_health.py`\n- `tests/test_opml_edge_cases.py`\n- `tests/test_error_handling.py`\n\n**Configuration**:\n- `requirements.txt` - Add pytest-cov\n- `.github/workflows/ci-cd.yml` - Add coverage reporting\n- `pyproject.toml` or `setup.cfg` - Coverage configuration (optional)\n\n## Priority Justification\n\n**MEDIUM Priority** - Important for code quality and confidence in refactoring, but not blocking new features.\n\n## Estimated Effort\n\n4-6 hours:\n- 1h: Setup pytest-cov and generate baseline report\n- 2-3h: Write tests for critical paths and edge cases\n- 1h: Write error handling tests\n- 30min: CI/CD integration and documentation\n\n## Success Metrics\n\n- Overall coverage: ≥80%\n- Critical paths: 100% (story generation, CRUD)\n- Edge cases: Comprehensive coverage\n- CI/CD: Coverage report visible on every run\n- Future PRs: Coverage can't decrease without justification\n\n## Related\n\n- Technical Debt: docs/development/TECHNICAL_DEBT_v0.6.0.md\n- Existing Tests: tests/\n- CI/CD Workflow: .github/workflows/ci-cd.yml\n\n## Testing\n\n```bash\n# Generate coverage report\npytest --cov=app --cov-report=html\n\n# View HTML report\nopen htmlcov/index.html\n\n# Check coverage threshold\npytest --cov=app --cov-fail-under=80\n```\n\n## Definition of Done\n\n- pytest-cov installed and configured\n- Overall coverage ≥80%\n- Critical path coverage 100%\n- Coverage reporting in CI/CD\n- All new tests passing\n- Coverage report accessible to developers",
    "labels": ["technical-debt", "testing", "priority:P2", "epic:ops"],
    "milestone": "v0.6.0 - Intelligence & Polish"
  }
]

